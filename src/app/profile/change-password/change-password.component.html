<ng-container *ngIf="user$ | async as user">
    <mat-card class="half-width">
      <mat-card-header>
        <mat-card-title i18n>Change Password</mat-card-title>
      </mat-card-header>
      <mat-divider></mat-divider>
      <mat-card-content>
        <form
          [formGroup]="form"
          (ngSubmit)="onSubmit()"
          id="change-password-form"
        >
          <gt-form-error [errors]="formErrors()"></gt-form-error>
          <mat-form-field *ngIf="user.hasPasswordAuth" class="full-width first-field" appearance="outline">
            <mat-label i18n>Current Password</mat-label>
            <input matInput type="password" formControlName="current_password" />
            <mat-error
              ><span *ngIf="current_password?.errors?.required" i18n
                >Your current is required to change your password</span
              >
              <span *ngIf="current_password?.errors?.serverError">{{
                current_password?.errors?.serverError
              }}</span></mat-error
            >
          </mat-form-field>
          <mat-form-field class="full-width" [class.first-field]="!user.hasPasswordAuth" appearance="outline">
            <mat-label i18n>New Password</mat-label>
            <input matInput type="password" formControlName="new_password" />
            <mat-error
              ><span *ngIf="new_password?.errors?.minlength" i18n
                >Your password should be at least 8 characters long</span
              >
              <span *ngIf="new_password?.errors?.required" i18n
                >Type in your new password</span
              >
              <span *ngIf="new_password?.errors?.serverError">{{
                new_password?.errors?.serverError
              }}</span>
            </mat-error>
          </mat-form-field>
          <mat-form-field
            class="full-width"
            data-cy="confirm-password"
            appearance="outline"
          >
            <mat-label i18n>Confirm New Password</mat-label>
            <input
              matInput
              type="password"
              formControlName="new_password2"
              gtInputMatcher="new_password"
            />

            <mat-error
              ><span *ngIf="new_password2?.errors?.required" i18n
                >Type in your new password</span
              ><span *ngIf="new_password2?.errors?.notEqual" i18n
                >Your passwords don't match</span
              >
              <span *ngIf="new_password2?.errors?.serverError">{{
                new_password2?.errors?.serverError
              }}</span></mat-error
            >
          </mat-form-field>
          <gt-loading-button i18n-buttonText buttonText="Change Password" [loading]="loading()">
          </gt-loading-button>
        </form>
      </mat-card-content>
    </mat-card>
  <section></section>
</ng-container>
